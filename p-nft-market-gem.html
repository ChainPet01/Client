<div class="modal fade show" id="look-gem" tabindex="-1" aria-labelledby="exampleModalScrollableTitle"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
        <div class="modal-content xsjl-d">
            <div class="modal-header border-0">
                <button type="button" class="btn-close text-warning" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>

            <div class="modal-body p-0 p-md-2">
                <div class="row row-cols-1 row-cols-lg-2 s-market-upload m-0">
                    <div class="col text-center auction-left pt-0 pt-lg-5">
                        <img class="img-fluid w-75" src="images/big-elf.svg" alt="" id="marketGemElvesDialogImg">
                    </div>
                    <div class="col auction-right">
                        <h4 class="mb-4"><i>&nbsp;</i><span id="marketGemElvesDialogName"></span></h4>
                        <div class="prize-shu mb-4">
                            <li class="text-truncate pe-2"><span><s langtest="Owner">Owner</s> </span><s
                                    id="marketGemElvesDialogAuthor"></s></li>
                            <li class="text-truncate pe-2"><span><s langtest="Contract Address">Contract Address</s>
                                </span><s id="marketGemElvesDialogAddress"></s></li>
                            <li class="text-truncate pe-2"><span><s langtest="Token ID">Token ID</s>
                                </span><s id="marketGemElvesDialogTokenId"></s>
                            </li>
                            <li class="text-truncate pe-2"><span><s langtest="Price">Price</s>
                                </span><s id="marketGemElvesDialogPrice"></s><img class=" ps-2 bp-1"
                                    style="width: 26px;" src="images/cpet.png">
                            </li>
                        </div>
                        <div class="looktxt-bg">
                            <s langtest="Introduce">Introduce</s>
                        </div>
                        <div class="looktxt" id="marketGemElvesDialogIntroduce">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer text-white border-0 d-f">
                <div class="container-fluid">
                    <div class="row justify-content-center">
                        <div class="col-3 button-yellow py-2 py-lg-3 text-center text-uppercase" data-bs-dismiss="modal"
                            aria-label="Close">
                            <a href="javascript:;" onclick="buyGem()"><s id="marketGemElvesDialogBtn"
                                    langtest="Buy">Buy</s></a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!--弹窗结束-->


<div id="nav-market" class="container-lg-fluid mx-4">
    <nav>
        <div class="nav nav-tabs nav-tabs2" id="my-storage-tab" role="tablist">
            <a class=" active" id="nft-market-gems-market-tab" data-bs-toggle="tab" href="#nft-market-gems-market"
                role="tab" aria-controls="nft-market-gems-market" aria-selected="true"
                onclick="onTableGemsMarketList('energy',1)"><s langtest="Market-Market">Market</s></a>
            <a class="" id="nft-market-gems-selling-tab" data-bs-toggle="tab" href="#nft-market-gems-selling" role="tab"
                aria-controls="nft-market-gems-selling" aria-selected="false" onclick="onTableGemMySell('energy',1)"><s
                    langtest="Market-Selling">Selling</s></a>
            <a class="" id="nft-market-gems-record-tab" data-bs-toggle="tab" href="#nft-market-gems-record" role="tab"
                aria-controls="nft-market-gems-record" aria-selected="false" onclick="onTableGemLog(-1)"><s
                    langtest="Market-Record">Record</s></a>
        </div>
    </nav>
    <div class="tab-content mt-4 mt-md-5" id="my-storage-tabContent">
        <p><a style="color: #9895C0;" href="#" data-bs-toggle="modal" data-bs-target="#text-rule-market"><s
                    langtest="Market-Rule">Market rules>></s></a></p>
        <div class="tab-pane fade show active" id="nft-market-gems-market" role="tabpanel"
            aria-labelledby="nft-market-gems-market-tab">
            <!-- market -->
            <div class="col-12">
                <div class="row s-market-upload">
                    <!-- <div
                            class="col-12 text-center py-4 py-lg-0 text-lg-start col-lg-auto d-lg-flex align-items-center"> -->
                    <div class="col-6 d-flex align-items-center">
                        <b> <s langtest="Market-Total">Total</s>&nbsp;<s id="totalMarketGemNumber">0</s></b>
                    </div>
                    <!-- <div class="col text-center text-lg-end"> -->
                    <div class="col-6 text-end">
                        <!-- <form class="d-inline-flex s-market-8">
                                <input class="form-control" type="Search" placeholder="Search"
                                    aria-label="Search">
                                <button class="btn s-market-buttom " type="submit"><s
                                        langtest>Search</s></button>
                            </form> -->
                        <div class="s-market-9"><a href="#" data-bs-toggle="modal" data-bs-target="#shelves-gems"
                                onclick="shelvesGemBtnList(event)"><span class="font_family icon-xingzhuang"></span><s
                                    langtest="Market-Shelves">Shelves</s></a>
                        </div>

                    </div>
                </div>
            </div>
            <br>
            <!-- 这里数据循环开始 -->
            <div class="container-fluid p-0">
                <div class="row row-cols-2 row-cols-sm-3 row-cols-lg-4 g-2 g-lg-5" id="goodsGemListIds">
                    <!-- 数据调用内容 -->
                </div>
            </div>
            <!-- market -->
        </div>
        <div class="tab-pane fade" id="nft-market-gems-selling" role="tabpanel"
            aria-labelledby="nft-market-gems-selling-tab">
            <!-- selling -->
            <div class="col-12">
                <div class="row s-market-upload">
                    <div class="col-6 d-flex align-items-center">
                        <b> <s langtest="Market-Total">Total</s>&nbsp;<s id="totalGemSellingNumber">0</s></b>
                    </div>
                    <div class="col-6 text-end">
                        <div class="s-market-9"><a href="#" data-bs-toggle="modal" data-bs-target="#shelves-gems"
                                onclick="shelvesGemBtnList(event)"><span class="font_family icon-xingzhuang"></span><s
                                    langtest="Market-Shelves">Shelves</s></a>
                        </div>
                    </div>
                </div>

                <br>
                <!-- 这里数据循环开始 -->
                <div class="container-fluid p-0">
                    <div class="row row-cols-2 row-cols-sm-3 row-cols-lg-4 g-2 g-lg-5" id="myGoodsGemListIds">
                        <!-- 数据调用内容 -->
                    </div>
                </div>
            </div>
            <!-- selling -->
        </div>
        <div class="tab-pane fade" id="nft-market-gems-record" role="tabpanel"
            aria-labelledby="nft-market-gems-record-tab">
            <!-- record -->
            <div class="biaoge my-5">
                <!-- 时间段开始 -->
                <nav>
                    <div class="nav nav-tabs biaogehead" id="nav-tab" role="tablist">
                        <a class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" href="#nav-24" role="tab"
                            aria-controls="nav-home" aria-selected="true" onclick="onTableGemLog(24)"><s
                                langtest="Last-24-Hours">Last 24 Hours</s></a>
                        <a class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" href="#nav-7day" role="tab"
                            aria-controls="nav-profile" aria-selected="false" onclick="onTableGemLog(168)"><s
                                langtest="Day-7">Day 7</s></a>
                        <a class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" href="#nav-30day" role="tab"
                            aria-controls="nav-profile" aria-selected="false" onclick="onTableGemLog(720)"><s
                                langtest="Day-30">Day 30</s></a>
                    </div>
                </nav>

                <div class="tab-content" id="nav-tabContent">
                    <!-- 24小时内容开始 -->
                    <div class="tab-pane fade show active" id="nav-24" role="tabpanel" aria-labelledby="nav-home-tab">
                        <div
                            class="row row-cols-1 row-cols-sm-2 row-cols-md-3 align-items-center px-5 pb-5 biaogecenter">
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table1.svg" alt="">
                                    </div>
                                    <div class="col"><s langtest="Auction-Total-Transactions">Total
                                            Transactions</s><span id="marketGemTransactionTotal1"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table2.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Total-Transactions-Volume">Total
                                            Transactions Volume</s><span id="marketGemTransactionSum1"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table3.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Average-Price">Average
                                            Price</s><span id="marketGemTransactionAvg1"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 7天开始 -->
                    <div class="tab-pane fade" id="nav-7day" role="tabpanel" aria-labelledby="nav-profile-tab">
                        <div
                            class="row row-cols-1 row-cols-sm-2 row-cols-md-3 align-items-center px-5 pb-5 biaogecenter">
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table1.svg" alt="">
                                    </div>
                                    <div class="col"><s langtest="Auction-Total-Transactions">Total
                                            Transactions</s><span id="marketGemTransactionTotal7"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table2.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Total-Transactions-Volume">Total
                                            Transactions Volume</s><span id="marketGemTransactionSum7"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table3.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Average-Price">Average
                                            Price</s><span id="marketGemTransactionAvg7"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 30天开始 -->
                    <div class="tab-pane fade" id="nav-30day" role="tabpanel" aria-labelledby="nav-profile-tab">
                        <div
                            class="row row-cols-1 row-cols-sm-2 row-cols-md-3 align-items-center px-5 pb-5 biaogecenter">
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table1.svg" alt="">
                                    </div>
                                    <div class="col"><s langtest="Auction-Total-Transactions">Total
                                            Transactions</s><span id="marketGemTransactionTotal30"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table2.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Total-Transactions-Volume">Total
                                            Transactions Volume</s><span id="marketGemTransactionSum30"></span></div>
                                </div>
                            </div>
                            <div class="col mt-5">
                                <div class="row">
                                    <div class="col-auto"><img src="images/table3.svg" alt="">
                                    </div>
                                    <div class="col text-truncate"><s langtest="Auction-Average-Price">Average
                                            Price</s><span id="marketGemTransactionAvg30"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <!-- 顶部tabs -->
            <div class="biaoge mb-5 pb-5">

                <nav>
                    <div class="nav nav-tabs biaogehead" id="nav-tab" role="tablist">
                        <a class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" href="#nav-zuijinchengjiao"
                            role="tab" aria-controls="nav-home" aria-selected="true" onclick="onGemRecent(0)"><s
                                langtest="Recent-Transactions">Recent Transactions</s></a>
                        <a class="nav-link" id="nav-profile-tab" data-bs-toggle="tab" href="#nav-wodejilu" role="tab"
                            aria-controls="nav-profile" aria-selected="false" onclick="onMyGemRecent(0)"><s
                                langtest="Auction-My-Record">My Record</s></a>
                    </div>
                </nav>

                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-zuijinchengjiao" role="tabpanel"
                        aria-labelledby="nav-home-tab">
                        <!-- 基本信息内容 -->

                        <div class="row p-3 biaogecenter">
                            <table class="table table-striped align-middle">
                                <thead>
                                    <tr class="row row-cols-5">
                                        <th scope="col"><s langtest="Role">Role</s></th>
                                        <th scope="col"><s langtest="Buyer">Buyer</s></th>
                                        <th scope="col"><s langtest="Seller">Seller</s></th>
                                        <th scope="col"><s langtest="Price">Price</s></th>
                                        <th scope="col"><s langtest="Time">Time</s></th>
                                    </tr>
                                </thead>
                                <tbody id="marketTransactionListGem">
                                </tbody>
                            </table>
                        </div>

                        <!-- 基本信息内容 -->
                    </div>
                    <div class="tab-pane fade" id="nav-wodejilu" role="tabpanel" aria-labelledby="nav-profile-tab">
                        <!-- 出价历史内容 -->
                        <div class="row p-3 biaogecenter">
                            <table class="table table-striped align-middle">
                                <thead>
                                    <tr class="row row-cols-5">
                                        <th scope="col"><s langtest="Role">Role</s></th>
                                        <th scope="col"><s langtest="Buyer">Buyer</s></th>
                                        <th scope="col"><s langtest="Seller">Seller</s></th>
                                        <th scope="col"><s langtest="Price">Price</s></th>
                                        <th scope="col"><s langtest="Time">Time</s></th>
                                    </tr>
                                </thead>
                                <tbody id="marketMyTransactionListGem">
                                </tbody>
                            </table>
                        </div>
                        <!-- 出价历史内容 -->
                    </div>

                </div>
            </div>
            <!-- record -->
        </div>
    </div>

    <div class="modal fade show" id="shelves-gems" tabindex="-1" aria-labelledby="exampleModalScrollableTitle"
        style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content xsjl-d">

                <div class="modal-header border-0">
                    <h5 class="modal-title text-center text-white w-100"><s langtest="Please-Select">Please Select</s>
                    </h5>
                    <button type="button" class="btn-close text-warning" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>

                <div class="modal-body xdjl mx-3">
                    <div class="container-fluid p-0">
                        <div class="row row-cols-2 row-cols-md-2 row-cols-lg-4" id="shelvesGemsDialogList">
                        </div>
                    </div>
                </div>

                <div class="modal-footer text-white border-0 d-f">
                    <div class="container-fluid">
                        <div class="row row-cols-auto justify-content-center">
                            <!-- <div class="col"><s langtest="Price">Price</s>: </div> -->
                            <div class="col"><s langtest="Price">Price</s>: <input class="sjsl" type="text"
                                    placeholder="Please input price" aria-label="text" id="shelvesMarketGemsPrice"
                                    oninput="value=value.replace(/[^\.\d]/g,'')"><img class=" ps-2 bp-1"
                                    style="width: 26px;" src="images/cpet.png">
                            </div>
                            <!-- <div class="col"><s>CPET</s></div> -->
                        </div>
                        <div class="row justify-content-center mt-4">
                            <div class="col-6 button-yellow py-2 py-lg-3 text-center" data-bs-dismiss="modal"
                                aria-label="Close">
                                <a href="javascript:;" onclick="onMarketSelectGem()"><s langtest="Ok">Ok</s></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <span id="s-market-gem-data"></span>
</div>







<script type="text/javascript">
    $("#s-market-gem-data").attr('pageType', 'market');
    // addCookie('tabs_small_nav', "1", 30);
    // window.onload = function () {
    //     console.log('onload')
    // $("#s-market-data").attr('pageType', 'market');
    // onTableMarketList('energy', 1);

    // }
    //市场列表
    function onTableGemsMarketList(type, page) {
        $("#s-market-gem-data").attr('pageType', 'market');
        $("#marketPageGem").text('')
        marketListData(type, page, function (result) {
            if (result.code == 200) {
                updateMarketGemElvesList(type, result);
            } else {
                // cocoMessage.warning(result.message, 0);
                $.message({
                    message: result.message,
                    type: 'warning'
                });
            }
        });
    }

    function onTableGemMySell(type, page) {
        $("#s-market-gem-data").attr('pageType', 'my');
        $("#marketPageGem").text('')
        mySellListData(type, page, function (result) {
            if (result.code == 200) {
                updateSellingGemsElvesList(type, result);
            } else {
                // cocoMessage.warning(result.message, 0);
                $.message({
                    message: result.message,
                    type: 'warning'
                });
            }
        })
    }
    var timeTableGem = 24;

    function onTableGemLog(time) {
        $("#marketPageGem").text('')
        if (time == -1) {
            time = timeTableGem;
            // console.log($("#tabsContentIdGem").height());
        }
        timeTableGem = time;
        // console.log('onTableGemLog:' + time);
        tabsContentIdHeight = $("#tabsContentIdGem").height();

        onGemRecent(time);
    }

    function onGemRecent(time) {
        if (time == 0) time = timeTableGem;
        // time = 168;//测试 7天 168小时
        marketLogListData("energy", time, function (result) {
            if (result == null) {
                $("#marketTransactionListGem").children().remove();
                // resetMiningData();
                // window.location.reload();
            } else {
                if (result.code == 200) {
                    updateGemRecordLogList(result)
                } else {
                    // cocoMessage.warning(result.message, 0);
                    $.message({
                        message: result.message,
                        type: 'warning'
                    });
                }
            }
        });
    }

    function onMyGemRecent(time) {
        if (time == 0) time = timeTableGem;
        // time = 168;//测试 7天 168小时
        myMarketTransactionLogData("energy", time, function (result) {
            if (result == null) {
                $("#marketMyTransactionListGem").children().remove();
                // resetMiningData();
                // window.location.reload();
            } else {
                if (result.code == 200) {
                    updateMyGemRecordLogList(result)
                } else {
                    // cocoMessage.warning(result.message, 0);
                    $.message({
                        message: result.message,
                        type: 'warning'
                    });
                }
            }
        });
    }

    var walletAddressGem = "";
    var selectIdValueGem = 0;
    var selectTokenIdValueGem = 0;

    function shelvesGemBtnList(type) {
        isOnline(function (online) { //必须要验证线上是否在线
            var data = getCookie();
            if (online.data && data != "") { //在线 进行赎回操作
                putAwayGoodsData("energy", function (result) {
                    if (result == null) {
                        // resetMiningData();
                        // window.location.reload();
                    } else {
                        if (result.code == 200) {
                            walletAddressGem = result.data.toAddress;
                            updateGemMarketShelvesElvesList(result);
                        } else {
                            // cocoMessage.warning(result.message, 3000);
                            $.message({
                                message: result.message,
                                type: 'warning'
                            });
                        }
                    }
                });
            } else {
                $.message({
                    message: "User not login,Please wait.",
                    type: 'info'
                });
                setTimeout(function () {
                    loginEthereum();
                }, 1000);
            }
        });
    }
    var removeTokenIdGem = 0;

    function selectGemMarketElves(elfId, elfTokenId, i, total) {
        selectIdValueGem = elfId;
        selectTokenIdValueGem = elfTokenId;
        for (let i = 0; i < total; i++) {
            var id = "#marketGemPoolSelect" + i;
            $(id).removeClass('select-active');
        }
        var id = "#marketGemPoolSelect" + i;
        $(id).addClass('select-active');
    }

    function onMarketSelectGem() {
        const inputParam = Number(document.getElementById('shelvesMarketGemsPrice').value);
        if (isNaN(inputParam)) {
            // cocoMessage.warning("Invalid parameter", 0);
            $.message({
                message: "Invalid parameter",
                type: 'warning'
            });
            return;
        }
        if (inputParam <= 0) {
            // cocoMessage.warning("Please input price", 0);
            $.message({
                message: "Please input price",
                type: 'warning'
            });
            return;
        }
        if (selectIdValueGem > 0) {
            isOnline(function (online) { //必须要验证线上是否在线
                var data = getCookie();
                if (online.data && data != "") { //在线 进行赎回操作
                    loading();
                    var pageType = $("#s-market-gem-data").attr('pageType');
                    approvedNFT(walletAddressGem, selectTokenIdValueGem, selectIdValueGem, function (res, id, tokenId) {
                        loaded();
                        if (res == null) { } else {
                            loading();
                            sellGoodsData('energy', id, inputParam, pageType, function (result) {
                                loaded();
                                if (result == null) {
                                    // cocoMessage.warning('unknown', 0);
                                    $.message({
                                        message: 'unknown',
                                        type: 'warning'
                                    });
                                } else {
                                    if (result.code == 200) {
                                        $.message("Shelves Succeed!");
                                        if (pageType == 'my') {
                                            updateSellingGemsElvesList("energy", result);
                                        }
                                        else {
                                            updateMarketGemElvesList('energy', result);
                                        }
                                    } else {
                                        // cocoMessage.warning(result.message, 3000);
                                        $.message({
                                            message: result.message,
                                            type: 'warning'
                                        });
                                    }
                                }
                            })
                        }
                    });
                } else {
                    $.message({
                        message: "User not login,Please wait.",
                        type: 'info'
                    });
                    setTimeout(function () {
                        loginEthereum();
                    }, 1000);
                }
            });
        } else {
            // cocoMessage.warning("Please select goods", 3000);
            $.message({
                message: "Please select goods",
                type: 'warning'
            });
        }
    }

    function buyGem() {
        var btnText = $("#marketGemElvesDialogBtn").attr("langtest");;
        var elf = JSON.parse($("#s-market-gem-data").attr('elves'));
        var toAddress = $("#s-market-gem-data").attr('toaddress');
        isOnline(function (online) { //必须要验证线上是否在线
            var data = getCookie();
            if (online.data && data != "") { //在线 进行赎回操作
                if (btnText == 'Market-Take') {
                    loading();
                    var removeTokenIdGem = $("#s-market-gem-data").attr('removeTokenIdGem');
                    var pageType = $("#s-market-gem-data").attr('pageType');
                    removeApprovedNFT(removeTokenIdGem, function (res, tokenId) {
                        loaded();
                        if (res == null) { } else {
                            loading();
                            sellBackGoodsData("energy", tokenId, pageType, function (result) {
                                loaded();
                                if (result.code == 200) {
                                    $.message("Take Succeed!");
                                    if (pageType == 'my') {
                                        updateSellingGemsElvesList("energy", result);
                                    }
                                    else {
                                        updateMarketGemElvesList("energy", result);
                                    }
                                    // window.location.reload();
                                } else {
                                    // cocoMessage.warning(result.message, 0);
                                    $.message({
                                        message: result.message,
                                        type: 'warning'
                                    });
                                }
                            })
                        }
                    });
                } else {
                    loading();
                    transferToken(toAddress, elf.hash, elf.price, function (res, tokenId) {
                        loaded();
                        if (res == null) { } else {
                            loading();
                            buyGoodsData("energy", res.transactionHash, res.from, tokenId, function (result) {
                                loaded()
                                if (result.code == 200) {
                                    $.message("Transfer Succeed!");
                                    updateMarketGemElvesList("energy", result);
                                    updateUserInfo();
                                } else {
                                    // cocoMessage.warning(result.message, 3000);
                                    $.message({
                                        message: result.message,
                                        type: 'warning'
                                    });
                                }
                            })
                        }
                    });
                }
            } else {
                $.message({
                    message: "User not login,Please wait.",
                    type: 'info'
                });
                setTimeout(function () {
                    loginEthereum();
                }, 1000);
            }
        });
    }
    /**
     * 更新上架列表
     * */
    function updateGemMarketShelvesElvesList(result) {
        $("#shelvesGemsDialogList").children().remove();
        var list = result.data.putList;
        if (list != undefined && list != null) {
            for (let i = 0; i < list.length; i++) {
                var insertText = " \
                                <div class=\"col di text-center mt-2 mb-5 mining-link\">\
                                    <div id=\"marketGemPoolSelect" + i + "\">\
                                        <a class=\"\" href=\"javaScript:\" onclick='selectGemMarketElves(" + list[i].id + "," + list[i].hash + "," + i + "," + list.length + ")'>\
                                            <div class=\"zi text-truncate px-4 w-100\">" + list[i].nickname + "</div>\
                                            <div class=\"tu\"><img class=\"img-fluid\" src=\"images/energys/" + list[i].name + "2.png\" alt=\"\"></div>\
                                            <img src=\"images/xsjl-bg.svg\" alt=\"\">\
                                        </a>\
                                    </div>\
                                </div>";
                $("#shelvesGemsDialogList").append(insertText);
            }
        }
    }
    /**
     * 更新出售精灵列表
     * */
    function updateMarketGemElvesList(type, result) {
        var isShowPage = false;
        var totalPage = Math.ceil(result.data.total / 8);
        $("#marketPageGem").text('')
        $("#marketPageGem").zPager({
            totalData: result.data.total, //数据总条数
            pageData: 8, //每页数据条数
            pageCount: totalPage, //总页数
            current: result.data.currPage, //当前页码数
            htmlBox: $('#wraper'),
            btnShow: true,
            ajaxSetData: false,
            currentPage: function (curPage) {
                if (isShowPage) {
                    // console.log("当前页码数：" + curPage);
                    onTableGemsMarketList(type, curPage);
                }
                isShowPage = true;
            }
        });

        $("#s-market-gem-data").attr('toaddress', result.data.toAddress);
        $("#totalMarketGemNumber").text(result.data.total);
        $("#goodsGemListIds").children().remove();
        var list = result.data.goodsDTOList;
        for (let i = 0; i < list.length && i < 8; i++) {
            var typePath = '/';
            var name = list[i].name;
            var nickname = list[i].nickname;
            var level = list[i].level;
            var price = list[i].price;
            var hash = list[i].hash;
            // var power = list[i].power;
            if (type == 'elf') {
                typePath = "elves";
            } else {
                typePath = "energys";
            }
            var market_bg = "s-market-box";
            switch (level) {
                case 1:
                    market_bg = 's-market-box-white';
                    break;
                case 2:
                    market_bg = 's-market-box-green';
                    break;
                case 3:
                    market_bg = 's-market-box-pepur';
                    break;
                case 4:
                    market_bg = 's-market-box-orange';
                    break;
                case 5:
                    market_bg = 's-market-box-red';
                    break;
                case 6:
                    market_bg = 's-market-box-black';
                    break;
            }
            var nn = get_str(nickname);
            // var insertText =
            // "<div class=\"col mb-4\"> \
            //             <div class=\"s-market-box\"> \
            //                 <div class=\"top-0 text-truncate pt-3 pt-md-4 text-white text-center\"><h6><s langtest=\"" + nickname + "\">" + nn + "</s></h6><s>#" + hash + "</s></div> \
            //                 <a href=\"#\" data-bs-toggle=\"modal\" data-bs-target=\"#look-gem\" onclick ='marketGemElvesInfo(" + JSON.stringify(list[i]) + ")'><img class=\"img-fluid p-0\" src=\"images/" + typePath + '/' + name + "2.png\" alt=\"\"></a>\
            //                 <div class=\"d-flex text-white text-truncate py-1 py-md-2 px-3\"><div></div><div class=\"ms-auto ps-2\"><s langtest>" + price + "</s><small><img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"></small></div></div>\
            //             </div> \
            //         </div>"
            var insertText =
                "<div class=\"col mb-4\"> \
                        <div class='s-market-box'> \
                            <a href=\"#\" data-bs-toggle=\"modal\" data-bs-target=\"#look-gem\" onclick ='marketGemElvesInfo(" + JSON.stringify(list[i]) + ")'> \
                                <div class=\""+ market_bg + "\"> \
                                    <img class=\"img-fluid p-0\" src=\"images/" + typePath + '/' + name + "2.png\" alt=\"\">\
                                </div> \
                                <div class=\"top-0 text-truncate pt-3 pt-md-4 text-white text-center\"><h4 style=\"color: #9AA0D1;\" ><s langtest=\"" + nickname + "\">" + nn + "</s></h4><s>#" + hash + "</s></div> \
                                <div class=\"d-flex text-white text-truncate py-1 py-md-2 px-3\"><div class=\"ms-auto ps-2\"><s>" + price + "</s><small><img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"> </small></div></div>\
                            </a> \
                        </div> \
                    </div>"
            $("#goodsGemListIds").append(insertText);
        }
    }

    function marketGemElvesInfo(elves) {
        var nn = get_str(elves.nickname);
        $("#s-market-gem-data").attr('removeTokenIdGem', elves.hash);
        $("#marketGemElvesDialogImg").attr('src', "images/energys/" + elves.name + "2.png");
        $("#marketGemElvesDialogName").text(nn);
        $("#marketGemElvesDialogAuthor").text(elves.userName);
        $("#marketGemElvesDialogAddress").text(elves.address);
        $("#marketGemElvesDialogTokenId").text("#" + elves.hash);
        $("#marketGemElvesDialogPrice").text(elves.price);
        $("#marketGemElvesDialogIntroduce").text(elves.introduce); //

        var data = getCookie();
        if (data != "") {
            var tmp = JSON.parse(data).hash;
            if (tmp == elves.userName) {
                var n = get_str("Market-Take");
                $("#marketGemElvesDialogBtn").text(n);
                $("#marketGemElvesDialogBtn").attr("langtest", "Market-Take");
            } else {
                var n = get_str("Buy");
                $("#marketGemElvesDialogBtn").text(n);
                $("#marketGemElvesDialogBtn").attr("langtest", "Buy");
            }
        }
        $("#s-market-gem-data").attr('elves', JSON.stringify(elves));
    }

    function updateSellingGemsElvesList(type, result) {
        var isShowPage = false;
        var totalPage = Math.ceil(result.data.total / result.data.pageShowMax);
        $("#marketPageGem").text('')
        $("#marketPageGem").zPager({
            totalData: result.data.total, //数据总条数
            pageData: 8, //每页数据条数
            pageCount: totalPage, //总页数
            current: result.data.currPage, //当前页码数
            htmlBox: $('#wraper'),
            btnShow: true,
            ajaxSetData: false,
            currentPage: function (curPage) {
                if (isShowPage) {
                    // console.log("当前页码数：" + curPage);
                    onTableGemMySell(type, curPage);
                }
                isShowPage = true;
            }
        });

        $("#totalGemSellingNumber").text(result.data.total);
        $("#myGoodsGemListIds").children().remove();
        var list = result.data.goodsDTOList;
        for (let i = 0; i < list.length && i < 8; i++) {
            var typePath = '/';
            var name = list[i].name;
            var nickname = list[i].nickname;
            var level = list[i].level;
            var power = list[i].power;
            var price = list[i].price;
            var hash = list[i].hash;
            if (type == 'elf') {
                typePath = "elves";
            } else {
                typePath = "energys";
            }
            var market_bg = "s-market-box";
            switch (level) {
                case 1:
                    market_bg = 's-market-box-white';
                    break;
                case 2:
                    market_bg = 's-market-box-green';
                    break;
                case 3:
                    market_bg = 's-market-box-pepur';
                    break;
                case 4:
                    market_bg = 's-market-box-orange';
                    break;
                case 5:
                    market_bg = 's-market-box-red';
                    break;
                case 6:
                    market_bg = 's-market-box-black';
                    break;
            }
            var nn = get_str(nickname);
            // var insertText =
            //     "<div class=\"col mb-4\"> \
            //                 <div class=\"s-market-box\"> \
            //                     <div class=\"top-0 text-truncate pt-3 pt-md-4 text-white text-center \"><h6><s langtest=\"" + nickname + "\">" + nn + "</s></h6><s>#" + hash + "</s></div> \
            //                     <a href=\"#\" data-bs-toggle=\"modal\" data-bs-target=\"#look-gem\"  onclick ='marketGemElvesInfo(" + JSON.stringify(list[i]) + ")'><img class=\"img-fluid p-0\" src=\"images/" + typePath + '/' + name + "2.png\" alt=\"\"></a>\
            //                     <div class=\"d-flex text-white text-truncate  py-1 py-md-2 px-3\"><div></div><div class=\"ms-auto ps-2\"><s>" + price + "</s><small><img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"></small></div></div>\
            //                 </div> \
            //             </div>"
            var insertText =
                "<div class=\"col mb-4\"> \
                        <div class='s-market-box'> \
                            <a href=\"#\" data-bs-toggle=\"modal\" data-bs-target=\"#look\" onclick ='marketElvesInfo(" + JSON.stringify(list[i]) + ")'> \
                                <div class=\""+ market_bg + "\"> \
                                    <img class=\"img-fluid p-0\" src=\"images/" + typePath + '/' + name + "2.png\" alt=\"\">\
                                </div> \
                                <div class=\"top-0 text-truncate pt-3 pt-md-4 text-white text-center\"><h4 style=\"color: #9AA0D1;\" ><s langtest=\"" + nickname + "\">" + nn + "</s></h4><s>#" + hash + "</s></div> \
                                <div class=\"d-flex text-white text-truncate py-1 py-md-2 px-3\"><div class=\"ms-auto ps-2\"><s>" + price + "</s><small><img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"> </small></div></div>\
                            </a> \
                        </div> \
                    </div>"
            $("#myGoodsGemListIds").append(insertText);
        }
    }

    function updateGemRecordLogList(result) {
        $("#marketGemTransactionTotal1").text(result.data.total);
        $("#marketGemTransactionSum1").text(result.data.sum);
        $("#marketGemTransactionAvg1").text(result.data.avg);
        $("#marketGemTransactionTotal7").text(result.data.total);
        $("#marketGemTransactionSum7").text(result.data.sum);
        $("#marketGemTransactionAvg7").text(result.data.avg);
        $("#marketGemTransactionTotal30").text(result.data.total);
        $("#marketGemTransactionSum30").text(result.data.sum);
        $("#marketGemTransactionAvg30").text(result.data.avg);
        $("#marketTransactionListGem").children().remove();
        var list = result.data.list;
        if (list != null) {
            for (let i = 0; i < list.length; i++) {
                var typePath = '';
                var suffix = ".png";
                if (list[i].goodsType == 'elf') {
                    continue;
                } else {
                    typePath = "energys";
                }
                var insertText =
                    "<tr class=\"row row-cols-5\"> \
                        <td class=\"col  d-flex align-items-center\"> \
                            <img class=\"img-fluid mx-auto sarket-table-img\" src=\"images/" + typePath + "/" + list[i].goodsName + suffix + "\" alt=\"\">\
                        </td>\
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].buyerUserHash + "</div></td> \
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].sellerUserHash + "</div></td> \
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].goodsPrice + "<img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"></div></td> \
                            <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].transactionTime + "</div></td> \
                        </tr>"
                $("#marketTransactionListGem").append(insertText);
            }
        }
    }

    function updateMyGemRecordLogList(result) {
        $("#marketGemTransactionTotal1").text(result.data.total);
        $("#marketGemTransactionSum1").text(result.data.sum);
        $("#marketGemTransactionAvg1").text(result.data.avg);
        $("#marketGemTransactionTotal7").text(result.data.total);
        $("#marketGemTransactionSum7").text(result.data.sum);
        $("#marketGemTransactionAvg7").text(result.data.avg);
        $("#marketGemTransactionTotal30").text(result.data.total);
        $("#marketGemTransactionSum30").text(result.data.sum);
        $("#marketGemTransactionAvg30").text(result.data.avg);
        $("#marketMyTransactionListGem").children().remove();
        var list = result.data.list;
        if (list != null) {
            for (let i = 0; i < list.length; i++) {
                var typePath = '';
                var suffix = ".png";
                if (list[i].goodsType == 'elf') {
                    continue;
                } else {
                    typePath = "energys";
                }
                var insertText =
                    "<tr class=\"row row-cols-5\"> \
                        <td class=\"col  d-flex align-items-center\"> \
                            <img class=\"img-fluid mx-auto sarket-table-img\" src=\"images/" + typePath + "/" + list[i].goodsName + suffix + "\" alt=\"\">\
                        </td>\
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].buyerUserHash + "</div></td> \
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].sellerUserHash + "</div></td> \
                        <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].goodsPrice + "<img class=\" ps-2 bp-1\" style=\"width: 26px;\" src=\"images/cpet.png\"></div></td> \
                            <td class=\"col\"><div class=\"text-truncate py-4 py-lg-5\">" + list[i].transactionTime + "</div></td> \
                        </tr>"
                $("#marketMyTransactionListGem").append(insertText);
            }
        }
    }
</script>
<!-- <script src="js/libs/page/js/jquery.z-pager.js" type="text/javascript" charset="utf-8"></script> -->